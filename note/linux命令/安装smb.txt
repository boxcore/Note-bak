安装smb

yum -y install samba
rpm -qa | grep samba
whereis samba 

chkconfig smb on

vi /etc/samba/smb.conf

# vi /etc/sysconfig/iptables  //
-A INPUT -m state --state NEW -m tcp -p tcp --dport 139 -j ACCEPT
-A INPUT -m state --state NEW -m tcp -p tcp --dport 445 -j ACCEPT
-A INPUT -p udp -m udp --dport 137 -j ACCEPT
-A INPUT -p udp -m udp --dport 138 -j ACCEPT

[root@sample ~]# chkconfig smb on　 ← 设置 Samba 自启动  
[root@sample ~]# chkconfig --list smb　 ← 确认 Samba 启动标签，确认 2-5 为 on 的状态  
smb 0:off 1:off 2:on 3:on 4:on 5:on 6:off  
[root@sample ~]# /etc/rc.d/init.d/smb start　 ← 启动 Samba 服务  
Starting SMB services: [ OK ]
Starting NMB services: [ OK ]

=============================================================
[global]
workgroup  =  工作组
server  string  =  描述
log  file  =	日志位置
max  log  size  =  日志最大大小 			KB
security  =  user		安全等级
user	使用samba用户登录。注意：samba用户由系统用户转变过来。要把用户生成为samba用户，此用户必须已经是系统用户
share	不用密码
server	使用验证服务器验证
domain	域控制器验证

·share   definitions		共享设置

[共享目录名]
commetn  =  目录描述
browseable  =  yes		目录是否对没有权限的用户可见
writeable  =  yes		可写（要与系统目录权限相与）
valid  users  =  用户名	用户限制（目录是哪个用户所有）
path  =  /www			指定共享目录位置
====================================================================

例子：
	共享两个目录，一个是pub    位置在 /pub	所有用户都能访问，所有用户都能上传

			/soft	位置在  /soft		只有aa用户能访问，上传。其他用户不能访问

			       
[pub]
        comment = all access		#？？
        browseable = yes
        path = /pub
        writable = yes
[soft]
        browseable = yes
        path = /soft
        writable=yes

			mkdir  /pub
			mkdir  /soft
			chmod 777 /pub
			chmod 700 /soft
			chown aa  /soft

			service smb  restart

6. 把系统用户声明为samba用户

			smbpasswd  -a  系统用户名
			smbpasswd  -a  aa

			smbpasswd  -x  用户名		删除samba用户

			pdbedit  -L	查看samba用户

7. 重启服务
service  smb  restart
			
注意：
samba权限和系统权限取最严格权限
samba用户必须是系统用户
启动的服务名是smb

		

8. 客户端使用

				windows：	共享目录
						net  use  *  /del			删除缓存

				linux客户端：
					smbclient  //192.168.140.253/soft -U aa

C. 文件服务器总结
1. vsftp	服务器：linux  windows   客户端：linux  windows    使用范围：内网  外网
			共享目录：普通用户是用户家目录，匿名用户是/var/ftp/目录。不能手工指定
			登录用户：系统用户，使用系统密码登录

2. samba：服务器：linux	windows	客户端:linux  windows使用范围：内网
			共享目录：手工指定
			登录用户：系统用户使用samba密码登录


B. samba服务器				

1. 简介
文件服务器 
			
2. 端口
smbd：	为clinet提高资源访问		tcp  139  445
nmbd：提供netbios主机名解析的	upd  137  138

3. 安装相关程序
samba			主程序包
samba-common	主要配置文件
samba-client		客户端文件
			
4. 相关文件
/etc/samba/smb.conf		配置文件		#  和  ；注释

5. 服务器段配置
vi  /etc/samba/smb.conf
·[global]
workgroup  =  工作组
server  string  =  描述
log  file  =	日志位置
max  log  size  =  日志最大大小 			KB
security  =  user		安全等级
user	使用samba用户登录。注意：samba用户由系统用户转变过来。要把用户生成为samba用户，此用户必须已经是系统用户
share	不用密码
server	使用验证服务器验证
domain	域控制器验证

·share   definitions		共享设置

[共享目录名]
commetn  =  目录描述
browseable  =  yes		目录是否对没有权限的用户可见
writeable  =  yes		可写（要与系统目录权限相与）
valid  users  =  用户名	用户限制（目录是哪个用户所有）
path  =  /www			指定共享目录位置


			例子：
				共享两个目录，一个是pub    位置在 /pub	所有用户都能访问，所有用户都能上传

						/soft	位置在  /soft		只有aa用户能访问，上传。其他用户不能访问

			       
[pub]
        comment = all access		#？？
        browseable = yes
        path = /pub
        writable = yes
[soft]
        browseable = yes
        path = /soft
        writable=yes

			mkdir  /pub
			mkdir  /soft
			chmod 777 /pub
			chmod 700 /soft
			chown aa  /soft

			service smb  restart

6. 把系统用户声明为samba用户

			smbpasswd  -a  系统用户名
			smbpasswd  -a  aa

			smbpasswd  -x  用户名		删除samba用户

			pdbedit  -L	查看samba用户

7. 重启服务
service  smb  restart
			
注意：
samba权限和系统权限取最严格权限
samba用户必须是系统用户
启动的服务名是smb

		

8. 客户端使用

				windows：	共享目录
						net  use  *  /del			删除缓存

				linux客户端：
					smbclient  //192.168.140.253/soft -U aa